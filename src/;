module Parser where


newtype Parser a = Parser { parse :: String -> Either String (a,String) }

runParser :: Parser a -> String -> a
runParser p s = case parse p s of
    Right (res, "") -> res
    Right (_, rest)  -> Left $ "Parsing finished before end of input: " ++ rest
    Left err -> Left err
